# Security Configuration Assessment
# CIS Checks for Windows 2016 RTM Member Server L2
# Copyright (C) 2015-2020, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Benchmark for Microsoft Windows Server 2019 RTM (Release 1809) v1.0.1 - 11-22-2019


policy:
  id: "cis_win2019_memberL2"
  file: "cis_win2019_memberL2.yml"
  name: "CIS benchmark for Windows 2019 RTM Member Server L2"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft Windows Server 2019."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check that the Windows platform is Windows Server 2019 RTM"
  description: "Requirements for running the CIS benchmark Member Server L2 under Windows Server 2019 RTM"
  condition: all
  rules:
    - 'r:HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion -> ProductName -> r:^Windows Server 2019'

checks:



###############################################
# 1 Account Policies
###############################################




###############################################
# 2 Local Policies
###############################################


#  2.3.7.6 - Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)
  - id: 16500 
    title: "Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)'"
    description: "This policy setting determines whether a user can log on to a Windows domain using cached account information."
    rationale: "The number that is assigned to this policy setting indicates the number of users whose logon information the computer will cache locally."
    remediation: "To establish the recommended configuration via GP, set the following UI path to 4 or fewer logon(s): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Number of previous logons to cache (in case domain controller is not available)."
    compliance:
      - cis: ["2.3.7.6"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    references:
      - 'CCE-38240-8'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount -> r:^0$|^1$|^2$|^3$|^4$'


###############################################
# 9 Windows Firewall with Advanced Security
###############################################




###############################################
# 17 Advanced Audit Policy Configuration
###############################################






###############################################
# 18 Administrative Templates (Computer)
###############################################
###############################################
# 18.1 Control Panel
###############################################
# 18.1.3 Ensure 'Allow Online Tips' is set to 'Disabled' (Scored)
  - id: 16501 
    title: "Ensure 'Allow Online Tips' is set to 'Disabled'"
    description: "This policy setting configures the retrieval of online tips and help for the Settings app. The recommended state for this setting is: Disabled ."
    rationale: "Due to privacy concerns, data should never be sent to any 3rd party since this data could contain sensitive information."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Allow Online Tips Note: This Group Policy path may not exist by default. It is provided by the Group Policy template ControlPanel.admx/adml that is included with the Microsoft Windows 10 Release 1709 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.1.3"]
      - cis_csc: ["9.1"]
      - pci_dss: ["1.3.4"]
      - tsc: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> AllowOnlineTips -> 0'

###############################################
# 18.4 MSS (Legacy)
###############################################
# 18.4.5 Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes'
  - id: 16502 
    title: "Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'"
    description: "This value controls how often TCP attempts to verify that an idle connection is still intact by sending a keep-alive packet."
    rationale: "An attacker who is able to connect to network applications could establish numerous connections to cause a DoS condition."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: 300,000 or 5 minutes (recommended): Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds."
    compliance:
      - cis: ["18.4.5"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1","CC6.1","CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - 'CCE-36868-8'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime -> 300000'

# 18.4.7 Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'
  - id: 16503 
    title: "Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'"
    description: "This setting is used to enable or disable the Internet Router Discovery Protocol (IRDP), which allows the system to detect and configure default gateway addresses automatically as described in RFC 1256 on a per-interface basis."
    rationale: "An attacker who has gained control of a computer on the same network segment could configure a computer on the network to impersonate a router."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)."
    compliance:
      - cis: ["18.4.7"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1","CC6.1","CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - 'CCE-38065-9'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery -> 0'

# 18.4.10 Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'
  - id: 16504 
    title: "Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'"
    description: "This setting controls the number of times that TCP retransmits an individual data segment (non-connect segment) before the connection is aborted."
    rationale: "A malicious user could exhaust a target computer's resources if it never sent any acknowledgment messages for data that was transmitted by the target computer."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: 3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted."
    compliance:
      - cis: ["18.4.10"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1","CC6.1","CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - 'CCE-37846-3'
      - 'https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions -> 3'

# 18.4.11 Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'
  - id: 16505 
    title: "Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'"
    description: "This setting controls the number of times that TCP retransmits an individual data segment (non-connect segment) before the connection is aborted."
    rationale: "A malicious user could exhaust a target computer's resources if it never sent any acknowledgment messages for data that was transmitted by the target computer."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: 3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted."
    compliance:
      - cis: ["18.4.11"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1","CC6.1","CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - 'CCE-36051-1'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions -> 3'


###############################################
# 18.5 Network
###############################################
###############################################
# 18.5.5 Fonts
###############################################
# 18.5.5.1 Ensure 'Enable Font Providers' is set to 'Disabled' (Scored)
  - id: 16506 
    title: "Ensure 'Enable Font Providers' is set to 'Disabled'"
    description: "This policy setting determines whether Windows is allowed to download fonts and font catalog data from an online font provider.The recommended state for this setting is: Disabled ."
    rationale: "In an enterprise managed environment the IT department should be managing the changes to the system configuration, to ensure all changes are tested and approved."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\Network\\Fonts\\Enable Font Providers Note: This Group Policy path may not exist by default. It is provided by the Group Policy template GroupPolicy.admx/adml that is included with the Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.5.5.1"]
      - cis_csc: ["3", "13"]
      - pci_dss: ["6.4.5"]
      - tsc: ["CC6.6","CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableFontProviders -> 0'

# Section 18.5.9 - Link-Layer Topology Discovery
# 18.5.9.1 Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'
  - id: 16507 
    title: "Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'"
    description: "This policy setting changes the operational behavior of the Mapper I/O network protocol driver."
    rationale: "To help protect from potentially discovering and connecting to unauthorized devices, this setting should be disabled to prevent responding to network traffic for network topology discovery."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Mapper I/O (LLTDIO) driver."
    compliance:
      - cis: ["18.5.9.1"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-38170-7'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableLLTDIO -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitLLTDIOOnPrivateNet -> 0'

# 18.5.9.2 (L2) Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'
  - id: 16508 
    title: "Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'"
    description: "This policy setting changes the operational behavior of the Responder network protocol driver."
    rationale: "To help protect from potentially discovering and connecting to unauthorized devices, this setting should be disabled to prevent responding to network traffic for network topology discovery."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Responder (RSPNDR) driver."
    compliance:
      - cis: ["18.5.9.2"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37959-4'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableRspndr -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitRspndrOnPrivateNet -> 0'

# Section 18.5.10 - Microsoft Peer-to-Peer Networking Services
  - id: 16509 
    title: "Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'"
    description: "The Peer Name Resolution Protocol (PNRP) allows for distributed resolution of a name to an IPv6 address and port number."
    rationale: "This setting enhances the security of the environment and reduces the overall risk exposure related to peer-to-peer networking."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Microsoft Peer-to-Peer Networking Services\\Turn off Microsoft Peer-to-Peer Networking Services."
    compliance:
      - cis: ["18.5.10.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37699-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled -> 1'

# Section 18.5.19.2 - Parameters
# 18.5.19.2.1 (L2) Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)') (Scored)
  - id: 16510 
    title: "Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)')"
    rationale: "Since the vast majority of private enterprise managed networks have no need to utilize IPv6 (because they have access to private IPv4 addressing), disabling IPv6 components reduces a possible attack surface that is also harder to monitor the traffic on."
    remediation: "To establish the recommended configuration, set the following Registry value to 0xff (255) (DWORD): HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters:DisabledComponents."
    compliance:
      - cis: ["18.5.19.2.1"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.2"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents -> 255'

# Section 18.5.20 - Windows Connect Now
# 18.5.20.1 (L2) Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled' (Scored)
  - id: 16511 
    title: "Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'"
    description: "This policy setting allows the configuration of wireless settings using Windows Connect Now (WCN)."
    rationale: "This setting enhances the security of the environment and reduces the overall risk exposure related to user configuration of wireless settings."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Configuration of wireless settings using Windows Connect Now."
    compliance:
      - cis: ["18.5.20.1"]
      - cis_csc: ["15.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37481-9'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> EnableRegistrars -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableUPnPRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableInBand802DOT11Registrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableFlashConfigRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableWPDRegistrar -> 0'

# 18.5.20.2 (L2) Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled' (Scored)
  - id: 16512 
    title: "Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'"
    description: "This policy setting prohibits access to Windows Connect Now (WCN) wizards."
    rationale: "Allowing standard users to access the Windows Connect Now wizard increases the risk and attack surface."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\Network\Network\\Windows Connect Now\\Prohibit access of the Windows Connect Now wizards."
    compliance:
      - cis: ["18.5.20.2"]
      - cis_csc: ["15.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36109-7'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi -> 1'

# Section 18.5.21 - Windows Connection Manager
# 18.5.21.2 (L2) Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled' (MS only) (Scored)
  - id: 16513 
    title: "Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'"
    description: "This policy setting prevents computers from connecting to both a domain based network and a non-domain based network at the same time."
    rationale: "The potential concern is that a user would unknowingly allow network traffic to flow between the insecure public network and the enterprise managed network."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\Network\\Windows Connection Manager\\Prohibit connection to non-domain networks when connected to domain authenticated network."
    compliance:
      - cis: ["18.5.21.2"]
      - cis_csc: ["12"]
      - pci_dss: ["1.3.4"]
      - tsc: ["CC6.6"]
    references:
      - 'CCE-37627-7'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain -> 1'

###############################################
# 18.7 Start Menu and Taskbar
###############################################

# 18.7.1.1 (L2) Ensure 'Turn off notifications network usage' is set to 'Enabled' (Scored)
  - id: 16514 
    title: "Ensure 'Turn off notifications network usage' is set to 'Enabled'"
    description: "This policy setting blocks applications from using the network to send notifications to update tiles, tile badges, toast, or raw notifications. This policy setting turns off the connection between Windows and the Windows Push Notification Service (WNS). This policy setting also stops applications from being able to poll application services to update tiles. The recommended state for this setting is: Enabled ."
    rationale: "Windows Push Notification Services (WNS) is a mechanism to receive 3rd-party notifications and updates from the cloud/Internet. In a high security environment, external systems, especially those hosted outside the organization, should be prevented from having an impact on the secure workstations."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled : Computer Configuration\\Policies\\Administrative Templates\\Start Menu and Taskbar\\Turn off notifications network usage Note: This Group Policy path may not exist by default. It is provided by the Group Policy template WPN.admx/adml that is included with the Microsoft Windows 8.0 & Server 2012 (non-R2) Administrative Templates (or newer)."
    compliance:
      - cis: ["18.7.1.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications -> NoCloudApplicationNotification -> 1'



# 18.8.22.1.2 (L2) Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled' (Scored)
  - id: 16515 
    title: "Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'"
    description: "This setting turns off data sharing from the handwriting recognition personalization tool. The handwriting recognition personalization tool enables Tablet PC users to adapt handwriting recognition to their own writing style by providing writing samples. The tool can optionally share user writing samples with Microsoft to improve handwriting recognition in future versions of Windows. The tool generates reports and transmits them to Microsoft over a secure connection. The recommended state for this setting is: Enabled."
    rationale: "A person's handwriting is Personally Identifiable Information (PII), especially when it comes to your signature. As such, it is unacceptable in many environments to automatically upload PII to a website without explicit approval by the user."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting personalization data sharing. Note: This Group Policy path may not exist by default. It is provided by the Group Policy template ShapeCollector.admx/adml that is included with the Microsoft Windows 7 & Server 2008 R2 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.8.22.1.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37911-5'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing -> 1'

# 18.8.22.1.3 (L2) Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled' (Scored)
  - id: 16516 
    title: "Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'"
    description: "Turns off the handwriting recognition error reporting tool. The handwriting recognition error reporting tool enables users to report errors encountered in Tablet PC Input Panel. The tool generates error reports and transmits them to Microsoft over a secure connection. Microsoft uses these error reports to improve handwriting recognition in future versions of Windows. The recommended state for this setting is: Enabled."
    rationale: "A person's handwriting is Personally Identifiable Information (PII), especially when it comes to your signature. As such, it is unacceptable in many environments to automatically upload PII to a website without explicit approval by the user."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting recognition error reporting. Note: This Group Policy path is provided by the Group Policy template InkWatson.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.3"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36203-8'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports -> 1'

# 18.8.22.1.4 (L2) Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' (Scored)
  - id: 16517 
    title: "Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'"
    description: "This policy setting specifies whether the Internet Connection Wizard can connect to Microsoft to download a list of Internet Service Providers (ISPs). The recommended state for this setting is: Enabled."
    rationale: "In an enterprise managed environment we want to lower the risk of a user unknowingly exposing sensitive data."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.4"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37163-3'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW -> 1'


# 18.8.22.1.7 (L2) Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled' (Scored)
  - id: 16518 
    title: "Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'"
    description: "This policy setting specifies whether the Windows Registration Wizard connects to Microsoft.com for online registration. The recommended state for this setting is: Enabled."
    rationale: "Users in an enterprise managed environment should not be registering their own copies of Windows, providing their own PII in the process."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Registration if URL connection is referring to Microsoft.com. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36352-3'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration -> 1'

# 18.8.22.1.8 (L2) Ensure 'Turn off Search Companion content file updates' is set to 'Enabled' (Scored)
  - id: 16519 
    title: "Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'"
    description: "This policy setting specifies whether Search Companion should automatically download content updates during local and Internet searches. The recommended state for this setting is: Enabled."
    rationale: "There is a small risk that users will unknowingly reveal sensitive information because of the topics they are searching for. This risk is very low because even if this setting is enabled users still must submit search queries to the desired search engine in order to perform searches."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Search Companion content file updates. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.8"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36884-5'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates -> 1'

# 18.8.22.1.9 (L2) Ensure 'Turn off the "Order Prints" picture task' is set to 'Enabled' (Scored)
  - id: 16520 
    title: "Ensure 'Turn off the \"Order Prints\" picture task' is set to 'Enabled'"
    description: "This policy setting specifies whether the \"Order Prints Online\" task is available from Picture Tasks in Windows folders. The Order Prints Online Wizard is used to download a list of providers and allow users to order prints online. The recommended state for this setting is: Enabled."
    rationale: "In an enterprise managed environment we want to lower the risk of a user unknowingly exposing sensitive data."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Order Prints\" picture task. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.9"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-38275-4'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard -> 1'

# 18.8.22.1.10 (L2) Ensure 'Turn off the "Publish to Web" task for files and folders' is set to 'Enabled' (Scored) 
  - id: 16521 
    title: "Ensure 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled'"
    description: "This policy setting specifies whether the tasks Publish this file to the Web, Publish this folder to the Web, and Publish the selected items to the Web are available from File and Folder Tasks in Windows folders. The Web Publishing wizard is used to download a list of providers and allow users to publish content to the Web. The recommended state for this setting is: Enabled."
    rationale: "Users may publish confidential or sensitive information to a public service outside of the control of the organization."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Publish to Web\" task for files and folders Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.10"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37090-8'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard -> 1'

# 18.8.22.1.11 (L2) Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' (Scored)
  - id: 16522 
    title: "Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'"
    description: "This policy setting specifies whether Windows Messenger can collect anonymous information about how the Windows Messenger software and service is used. Microsoft uses information collected through the Customer Experience Improvement Program to detect software flaws so that they can be corrected more quickly, enabling this setting will reduce the amount of data Microsoft is able to gather for this purpose. The recommended state for this setting is: Enabled."
    rationale: "Large enterprise managed environments may not want to have information collected by Microsoft from managed client computers."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the Windows Messenger Customer Experience Improvement Program. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.11"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36628-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP -> 2'

# 18.8.22.1.12 (L2) Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' (Scored)
  - id: 16523 
    title: "Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'"
    description: "This policy setting specifies whether Windows Messenger can collect anonymous information about how the Windows Messenger software and service is used. Microsoft uses information collected through the Windows Customer Experience Improvement Program to detect software flaws so that they can be corrected more quickly, enabling this setting will reduce the amount of data Microsoft is able to gather for this purpose. The recommended state for this setting is: Enabled."
    rationale: "Large enterprise managed environments may not want to have information collected by Microsoft from managed client computers."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Customer Experience Improvement Program. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.12"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36174-1'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable -> 0'

# 18.8.22.1.13 (L2) Ensure 'Turn off Windows Error Reporting' is set to 'Enabled' (Scored)
  - id: 16524 
    title: "Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'"
    description: "This policy setting controls whether or not errors are reported to Microsoft. Error Reporting is used to report information about a system or application that has failed or has stopped responding and is used to improve the quality of the product. The recommended state for this setting is: Enabled."
    rationale: "If a Windows Error occurs in a secure, enterprise managed environment, the error should be reported directly to IT staff for troubleshooting and remediation. There is no benefit to the corporation to report these errors directly to Microsoft, and there is some risk of unknowingly exposing sensitive data as part of the error."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Error Reporting. Note: This Group Policy path is provided by the Group Policy template ICM.admx/adml that is included with all versions of the Microsoft Windows Administrative Templates."
    compliance:
      - cis: ["18.8.22.1.13"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-35964-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled -> 1'

######################################
# 18.8.25 Kerberos
######################################
# 18.8.25.1 (L2) Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic' (Scored)
  - id: 16525 
    title: "Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'"
    description: "This policy setting allows you to set support for Kerberos to attempt authentication using the certificate for the device to the domain. Support for device authentication using certificate will require connectivity to a DC in the device account domain which supports certificate authentication for computer accounts. The recommended state for this setting is: Enabled: Automatic ."
    rationale: "Having stronger device authentication with the use of certificates is strongly encouraged over standard username and password authentication. Having this set to Automatic will allow certificate based authentication to be used whenever possible."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Automatic : Computer Configuration\\Policies\\Administrative Templates\\System\\Kerberos\\Support device authentication using certificate Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Kerberos.admx/adml that is included with the Microsoft Windows 10 RTM (Release 1507) Administrative Templates (or newer)."
    compliance:
      - cis: ["18.8.25.1"]
      - cis_csc: ["1.6"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitBehavior -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitEnabled -> 1'


#######################################
# 18.8.27 Locale Services
#######################################
# 18.8.27.1 (L2) Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled' (Scored)
  - id: 16526 
    title: "Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'"
    description: "This policy prevents automatic copying of user input methods to the system account for use on the sign-in screen. The user is restricted to the set of input methods that are enabled in the system account. The recommended state for this setting is: Enabled."
    rationale: "This is a way to increase the security of the system account."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Locale Services\\Disallow copying of user input methods to the system account for sign-in. Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Globalization.admx/adml that is included with the Microsoft Windows 8.0 & Server 2012 (non-R2) Administrative Templates (or newer)."
    compliance:
      - cis: ["18.8.26.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36343-2'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn -> 1'

#######################################
# 18.8.31 OS Policies
#######################################
# 18.8.31.1 (L2) Ensure 'Allow Clipboard synchronization across devices' is set to 'Disabled' (Scored)  
  - id: 16527 
    title: "Ensure 'Allow Clipboard synchronization across devices' is set to 'Disabled'"
    description: "This policy setting determines whether Clipboard contents can be synchronized across devices. The recommended state for this setting is: Disabled ."
    rationale: "Due to privacy concerns, clipboard data should stay local to the system and not synced across devices."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\OS Policies\\Allow Clipboard synchronization across devices"
    compliance:
      - cis: ["18.8.31.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowCrossDeviceClipboard -> 0'

# 18.8.31.2 (L2) Ensure 'Allow upload of User Activities' is set to 'Disabled' (Scored)  
  - id: 16528 
    title: "Ensure 'Allow upload of User Activities' is set to 'Disabled'"
    description: "This policy setting determines whether published User Activities can be uploaded to the cloud. The recommended state for this setting is: Disabled ."
    rationale: "Due to privacy concerns, data should never be sent to any 3rd party since this data could contain sensitive information."
    remediation: "TTo establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\System\\OS Policies\\Allow upload of User Activities"
    compliance:
      - cis: ["18.8.31.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> UploadUserActivities -> 0'

#######################################
# 18.8.34 Power Management
#######################################
#######################################
# 18.8.34.6 Sleep Settings
#######################################
# 18.8.34.6.1 (L2) Ensure 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled' (Scored)
  - id: 16529 
    title: "Ensure 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled'"
    description: "This policy setting allows you to control the network connectivity state in standby on modern standby-capable systems. The recommended state for this setting is: Disabled ."
    rationale: "Disabling this setting ensures that the computer will not be accessible to attackers over a WLAN network while left unattended, on battery and in a sleep state."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (on battery) Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Power.admx/adml that is included with the Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.8.34.6.1"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.4"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> 0'

# 18.8.34.6.2 (L2) Ensure 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled' (Scored)
  - id: 16530 
    title: "Ensure 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled'"
    description: "This policy setting allows you to control the network connectivity state in standby on modern standby-capable systems. The recommended state for this setting is: Disabled ."
    rationale: "Disabling this setting ensures that the computer will not be accessible to attackers over a WLAN network while left unattended, plugged in and in a sleep state."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (plugged in) Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Power.admx/adml that is included with the Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.8.34.6.2"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.4"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex -> 0'


# 18.8.37.2 (L2) Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated' (MS only) (Scored)
  - id: 16531 
    title: "Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated'"
    description: "This policy setting controls how the RPC server runtime handles unauthenticated RPC clients connecting to RPC servers."
    rationale: "Unauthenticated RPC communication can create a security vulnerability."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Authenticated: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Restrict Unauthenticated RPC clients."
    compliance:
      - cis: ["18.8.37.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - 'CCE-36559-3'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients -> 1'

# Section 18.8.45.5 - Microsoft Support Diagnostic Tool
# 18.8.45.5.1 (L2) Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to'Disabled' (Scored) 
  - id: 16532 
    title: "Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'"
    description: "This policy setting configures Microsoft Support Diagnostic Tool (MSDT) interactive communication with the support provider."
    rationale: "Due to privacy concerns, data should never be sent to any 3rd party since this data could contain sensitive information."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Microsoft Support Diagnostic Tool\\Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider."
    compliance:
      - cis: ["18.8.45.5.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-38161-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer -> 0'

# Section 18.8.45.11 - Windows Performance PerfTrack
# 18.8.45.11.1 (L2) Ensure 'Enable/Disable PerfTrack' is set to 'Disabled' (Scored)
  - id: 16533 
    title: "Ensure 'Enable/Disable PerfTrack' is set to 'Disabled'"
    description: "This policy setting specifies whether to enable or disable tracking of responsiveness events."
    rationale: "When enabled the aggregated data of a given event will be transmitted to Microsoft."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Windows Performance PerfTrack\\Enable/Disable PerfTrack."
    compliance:
      - cis: ["18.8.45.11.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36648-4'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> 0'

# Section 18.8.47 User Profiles
# 18.8.47.1 (L2) Ensure 'Turn off the advertising ID' is set to 'Enabled' (Scored)
  - id: 16534 
    title: "Ensure 'Turn off the advertising ID' is set to 'Enabled'"
    description: "This policy setting turns off the advertising ID, preventing apps from using the ID for experiences across apps."
    rationale: "Tracking user activity for advertising purposes, even anonymously, may be a privacy concern."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\User Profiles\\Turn off the advertising ID."
    compliance:
      - cis: ["18.8.47.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36931-4'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy -> 1'

# Section 18.8.50.1 - Time Providers
# 18.8.50.1.1 (L2) Ensure 'Enable Windows NTP Client' is set to 'Enabled' (Scored)
  - id: 16535 
    title: "Ensure 'Enable Windows NTP Client' is set to 'Enabled'"
    description: "This policy setting specifies whether the Windows NTP Client is enabled."
    rationale: "A reliable and accurate account of time is important for a number of services and security requirements, including but not limited to distributed applications, authentication services, multi-user databases and logging services."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Client."
    compliance:
      - cis: ["18.8.50.1.1"]
      - cis_csc: ["6.1"]
      - pci_dss: ["10.4"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC7.2"]
    references:
      - 'CCE-37843-0'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled -> 1'

# 18.8.50.1.2 (L2) Ensure 'Enable Windows NTP Server' is set to 'Disabled' (MS only) (Scored)
  - id: 16536 
    title: "Ensure 'Enable Windows NTP Server' is set to 'Disabled'"
    description: "This policy setting allows you to specify whether the Windows NTP Server is enabled."
    rationale: "The configuration of proper time synchronization is critically important in an enterprise managed environment both due to the sensitivity of Kerberos authentication timestamps and also to ensure accurate security logging."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Server."
    compliance:
      - cis: ["18.8.50.1.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37319-1'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled -> 0'






# 18.9.4.1 (L2) Ensure 'Allow a Windows app to share application data between users' is set to 'Disabled' (Scored)
  - id: 16537 
    title: "Ensure 'Allow a Windows app to share application data between users' is set to 'Disabled'"
    description: "Manages a Windows app's ability to share data between users who have installed the app. Data is shared through the SharedLocal folder. This folder is available through the Windows.Storage API. The recommended state for this setting is: Disabled ."
    rationale: "Users of a system could accidentally share sensitive data with other users on the same system."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App Package Deployment\\Allow a Windows app to share application data between users Note: This Group Policy path may not exist by default. It is provided by the Group Policy template AppxPackageManager.admx/adml that is included with the Microsoft Windows 10 RTM (Release 1507) Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.4.1"]
      - cis_csc: ["14.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager -> AllowSharedLocalAppData -> 0'

# 18.9.12.1 (L2) Ensure 'Allow Use of Camera' is set to 'Disabled' (Scored)
  - id: 16538 
    title: "Ensure 'Allow Use of Camera' is set to 'Disabled'"
    description: "This policy setting controls whether the use of Camera devices on the machine are permitted. The recommended state for this setting is: Disabled ."
    rationale: "Cameras in a high security environment can pose serious privacy and data exfiltration risks - they should be disabled to help mitigate that risk."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Camera\\Allow Use of Camera Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Camera.admx/adml that is included with the Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.12.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera -> AllowCamera -> 0'

# 18.9.16.2 (L2) Ensure 'Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service' is set to 'Enabled: Disable Authenticated Proxy usage' (Scored)
  - id: 16539 
    title: "Ensure 'Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service' is set to 'Enabled: Disable Authenticated Proxy usage'"
    description: "This policy setting controls whether the Connected User Experience and Telemetry service can automatically use an authenticated proxy to send data back to Microsoft. The recommended state for this setting is: Enabled: Disable Authenticated Proxy usage ."
    rationale: "Sending any data to a 3rd party vendor is a security concern and should only be done on an as needed basis."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Disable Authenticated Proxy usage : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service Note: This Group Policy path may not exist by default. It is provided by the Group Policy template DataCollection.admx/adml that is included with the Microsoft Windows 10 Release 1703 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.16.2"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableEnterpriseAuthProxy -> 1'

# 18.9.39.2 Ensure 'Turn off location' is set to 'Enabled'
  - id: 16540 
    title: "Ensure 'Turn off location' is set to 'Enabled'"
    description: "This policy setting turns off the location feature for the computer."
    rationale: "This setting affects the location feature (e.g. GPS or other location tracking)."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Location and Sensors\\Turn off location."
    compliance:
      - cis: ["18.9.39.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36886-0'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation -> 1'

# 18.9.43.1 (L2) Ensure 'Allow Message Service Cloud Sync' is set to 'Disabled' (Scored)
  - id: 16541 
    title: "Ensure 'Allow Message Service Cloud Sync' is set to 'Disabled'"
    description: "This policy setting allows backup and restore of cellular text messages to Microsoft's cloud services. The recommended state for this setting is: Disabled ."
    rationale: "In a high security environment, data should never be sent to any 3rd party since this data could contain sensitive information."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Messaging\\Allow Message Service Cloud Sync Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Messaging.admx/adml that is included with the Microsoft Windows 10 Release 1709 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.43.1"]
      - cis_csc: ["9.1", "13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging -> AllowMessageSync -> 0'

# 18.9.59.3.2.1 Ensure 'Restrict Remote Desktop Services users to a single Remote Desktop Services session' is set to 'Enabled'
  - id: 16542 
    title: "Ensure 'Restrict Remote Desktop Services users to a single Remote Desktop Services session' is set to 'Enabled'"
    description: "This policy setting allows you to restrict users to a single Remote Desktop Services session."
    rationale: "This setting ensures that users & administrators who Remote Desktop to a server will continue to use the same session - if they disconnect and reconnect, they will go back to the same session they were using before, preventing the creation of a second simultaneous session."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Connections\\Restrict Remote Desktop Services users to a single Remote Desktop Services session."
    compliance:
      - cis: ["18.9.59.3.2.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - 'CCE-37708-5'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fSingleSessionPerUser -> 1'

# Section 18.9.59.3.3 Device and Resource Redirection
# 18.9.59.3.3.1 Ensure 'Do not allow COM port redirection' is set to 'Enabled'
  - id: 16543 
    title: "Ensure 'Do not allow COM port redirection' is set to 'Enabled'"
    description: "This policy setting specifies whether to prevent the redirection of data to client COM ports from the remote computer in a Remote Desktop Services session."
    rationale: "In a more security-sensitive environment, it is desirable to reduce the possible attack surface."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow COM port redirection."
    compliance:
      - cis: ["18.9.59.3.3.1"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37696-2'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm -> 1'

# 18.9.59.3.3.3 Ensure 'Do not allow LPT port redirection' is set to 'Enabled'
  - id: 16544 
    title: "Ensure 'Do not allow LPT port redirection' is set to 'Enabled'"
    description: "This policy setting specifies whether to prevent the redirection of data to client LPT ports during a Remote Desktop Services session."
    rationale: "In a more security-sensitive environment, it is desirable to reduce the possible attack surface."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow LPT port redirection."
    compliance:
      - cis: ["18.9.59.3.3.3"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37778-8'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT -> 1'

# 18.9.59.3.3.4 Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'
  - id: 16545 
    title: "Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'"
    description: "This policy setting allows you to control the redirection of supported Plug and Play devices, such as Windows Portable Devices, to the remote computer in a Remote Desktop Services session."
    rationale: "In a more security-sensitive environment, it is desirable to reduce the possible attack surface."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow supported Plug and Play device redirection."
    compliance:
      - cis: ["18.9.59.3.3.4"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37477-7'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir -> 1'

# Section 18.9.60.3.10 - Session Time Limits
# 18.9.60.3.10.1 Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less'
  - id: 16546 
    title: "Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less'"
    description: "This policy setting allows you to specify the maximum amount of time that an active Remote Desktop Services session can be idle (without user input) before it is automatically disconnected."
    rationale: "This setting helps to prevent active Remote Desktop sessions from tying up the computer for long periods of time while not in use, preventing computing resources from being consumed by large numbers of inactive sessions."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: 15 minutes or less: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for active but idle Remote Desktop Services sessions."
    compliance:
      - cis: ["18.9.60.3.10.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - 'CCE-37562-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare <= 900000'

# 18.9.59.3.10.2 Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'
  - id: 16547 
    title: "Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'"
    description: "This policy setting allows you to configure a time limit for disconnected Remote Desktop Services sessions."
    rationale: "This setting helps to prevent active Remote Desktop sessions from tying up the computer for long periods of time while not in use, preventing computing resources from being consumed by large numbers of disconnected but still active sessions."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: 1 minute: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for disconnected sessions."
    compliance:
      - cis: ["18.9.59.3.10.2"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    references:
      - 'CCE-37949-5'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime -> 60000'




# 18.9.61.2 (L2) Ensure 'Allow Cloud Search' is set to 'Enabled: Disable Cloud Search' (Scored)
  - id: 16548 
    title: "Ensure 'Allow Cloud Search' is set to 'Enabled: Disable Cloud Search'"
    description: "This policy setting allows search and Cortana to search cloud sources like OneDrive and SharePoint. The recommended state for this setting is: Enabled: Disable Cloud Search ."
    rationale: "Due to privacy concerns, data should never be sent to any 3rd party since this data could contain sensitive information."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Disable Cloud Search : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow Cloud Search Note: This Group Policy path may not exist by default. It is provided by the Group Policy template Search.admx/adml that is included with the Microsoft Windows 10 Release 1709 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.61.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCloudSearch -> 0'


# 18.9.66.1 Ensure 'Turn off KMS Client Online AVS Validation' is set to 'Enabled'
  - id: 16549 
    title: "Ensure 'Turn off KMS Client Online AVS Validation' is set to 'Enabled'"
    description: "The Key Management Service (KMS) is a Microsoft license activation method that entails setting up a local server to store the software licenses."
    rationale: "Even though the KMS licensing method does not require KMS clients to connect to Microsoft, they still send KMS client activation state data to Microsoft automatically."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Software Protection Platform\\Turn off KMS Client Online AVS Validation."
    compliance:
      - cis: ["18.9.66.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket -> 1'

# Section 18.9.77.3 - MAPS
# 18.9.77.3.2 Ensure 'Join Microsoft MAPS' is set to 'Disabled'
  - id: 16550 
    title: "Ensure 'Join Microsoft MAPS' is set to 'Disabled'"
    description: "This policy setting allows you to join Microsoft Active Protection Service (MAPS), which Microsoft has now renamed to \"Windows Defender Antivirus Cloud Protection Service\"."
    rationale: "The information that would be sent can include things like location of detected items on your computer if harmful software was removed."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\MAPS\\Join Microsoft MAPS."
    compliance:
      - cis: ["18.9.77.3.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> SpynetReporting -> 0'

# Section - 18.9.77.9 - Reporting
  - id: 16551 
    title: "Ensure 'Configure Watson events' is set to 'Disabled'"
    description: "This policy setting allows you to configure whether or not Watson events are sent."
    rationale: "Watson events are the reports that get sent to Microsoft when a program or service crashes or fails, including the possibility of automatic submission."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Reporting\\Configure Watson events."
    compliance:
      - cis: ["18.9.77.9.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-36950-4'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts -> 1'

# 18.9.84.1 (L2) Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Disabled' (Scored)
  - id: 16552 
    title: "Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Disabled'"
    description: "This policy setting determines whether suggested apps in Windows Ink Workspace are allowed. The recommended state for this setting is: Disabled ."
    rationale: "This Microsoft feature is designed to collect data and suggest apps based on that data collected. Disabling this setting will help ensure your data is not shared with any third party."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Ink Workspace\\Allow suggested apps in Windows Ink Workspace Note: This Group Policy path may not exist by default. It is provided by the Group Policy template WindowsInkWorkspace.admx/adml that is included with the Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (or newer)."
    compliance:
      - cis: ["18.9.84.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace -> 0'

# Section 18.9.85 - Windows Installer
# 18.9.85.3 Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'
  - id: 16553 
    title: "Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'"
    description: "This policy setting controls whether Web-based programs are allowed to install software on the computer without notifying the user."
    rationale: "Suppressing the system warning can pose a security risk and increase the attack surface on the system."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Prevent Internet Explorer security prompt for Windows Installer scripts."
    compliance:
      - cis: ["18.9.85.3"]
      - cis_csc: ["7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - 'CCE-37524-6'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting -> 0'

# Section 18.9.97.2 - WinRM Service
# 18.9.97.2.2 Ensure 'Allow remote server management through WinRM' is set to 'Disabled'
  - id: 16554 
    title: "Ensure 'Allow remote server management through WinRM' is set to 'Disabled'"
    description: "This policy setting allows you to manage whether the Windows Remote Management (WinRM) service automatically listens on the network for requests on the HTTP transport over the default HTTP port."
    rationale: "Any feature is a potential avenue of attack, those that enable inbound network connections are particularly risky."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow remote server management through WinRM."
    compliance:
      - cis: ["18.9.97.2.2"]
      - cis_csc: ["3.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    references:
      - 'CCE-37927-1'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig -> 0'

# Section 18.9.98 - Windows Remote Shell
# 18.9.98.1 Ensure 'Allow Remote Shell Access' is set to 'Disabled'
  - id: 16555 
    title: "Ensure 'Allow Remote Shell Access' is set to 'Disabled'"
    description: "This policy setting allows you to manage configuration of remote access to all supported shells to execute scripts and commands."
    rationale: "Any feature is a potential avenue of attack, those that enable inbound network connections are particularly risky."
    remediation: "To establish the recommended configuration via GP, set the following UI path to Disabled: Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Shell\\Allow Remote Shell Access."
    compliance:
      - cis: ["18.9.98.1"]
      - cis_csc: ["3.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1","CC6.7","CC7.2"]
    references:
      - 'CCE-36499-2'
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess -> 0'

